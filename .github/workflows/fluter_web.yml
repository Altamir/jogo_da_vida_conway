name: "Build and Realease"

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4 
      
      - name: Configura o Java
        uses: actions/setup-java@v3.12.0
        with:
          distribution: 'oracle'
          java-version: '17'   
      
      - name: Configura flutter Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.3'
          channel: 'stable'
          
      - name: Futter version
        run: flutter --version

      - name: Obtendo dependencias
        run: flutter pub get

      - name: build
        run: flutter build web

      - name: Delpoy 
        env:
          CLOUD_FLARE_TOKEN: ${{ secrets.CLOUD_FLARE_TOKEN }}
          CLOUD_FLARE_ACCOUNT_ID: ${{ secrets.CLOUD_FLARE_ACCOUNT_ID }}
        uses: cloudflare/pages-action@v1.5.0
        with:         
          apiToken: "$CLOUD_FLARE_TOKEN"          
          accountId: "$CLOUD_FLARE_ACCOUNT_ID"   
          projectName: jogo_coway.altamir.dev        
          directory: build/web       
   

      
